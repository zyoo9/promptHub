# PromptHub - ç®€åŒ–ç‰ˆæç¤ºè¯ç‰ˆæœ¬ç®¡ç†å¹³å°æŠ€æœ¯è®¾è®¡æ–‡æ¡£

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

PromptHubæ˜¯ä¸€ä¸ªç®€åŒ–çš„æç¤ºè¯ç‰ˆæœ¬ç®¡ç†å¹³å°ï¼Œé‡‡ç”¨ä¸‰å±‚ç»“æ„ï¼š**é¡¹ç›® â†’ åˆ†æ”¯ â†’ ç‰ˆæœ¬**ã€‚æ— éœ€ç”¨æˆ·æ³¨å†Œç™»å½•ï¼Œæ”¯æŒéšæ„åˆ›å»ºé¡¹ç›®å’Œåˆ†æ”¯ï¼Œæ¯ä¸ªåˆ†æ”¯ç‹¬ç«‹è¿›è¡Œç‰ˆæœ¬ç®¡ç†ã€‚

## ğŸ¯ æ ¸å¿ƒéœ€æ±‚

### åŠŸèƒ½éœ€æ±‚
- **é¡¹ç›®ç®¡ç†**: åˆ›å»ºã€åˆ é™¤ã€é‡å‘½åé¡¹ç›®
- **åˆ†æ”¯ç®¡ç†**: åœ¨é¡¹ç›®ä¸‹åˆ›å»ºã€åˆ é™¤ã€åˆ‡æ¢åˆ†æ”¯
- **ç‰ˆæœ¬æ§åˆ¶**: åˆ†æ”¯å†…çš„æäº¤ã€å†å²è®°å½•ã€å›æ»šåŠŸèƒ½
- **å¯è§†åŒ–**: åˆ†æ”¯å›¾ã€æäº¤å†å²ã€å·®å¼‚å¯¹æ¯”
- **æŒ‰é’®æ“ä½œ**: æ‰€æœ‰æ“ä½œéƒ½é€šè¿‡UIæŒ‰é’®å®Œæˆ
- **æœ¬åœ°å­˜å‚¨**: æ‰€æœ‰æ•°æ®å­˜å‚¨åœ¨æœ¬åœ°ï¼Œæ— éœ€è´¦æˆ·

### éåŠŸèƒ½éœ€æ±‚
- **ç®€å•æ˜“ç”¨**: é›¶å­¦ä¹ æˆæœ¬ï¼Œç›´æ¥ä½¿ç”¨
- **æ€§èƒ½**: å¿«é€Ÿå“åº”ï¼Œæµç•…æ“ä½œ
- **å¯ç”¨æ€§**: ç®€æ´ç›´è§‚çš„ç•Œé¢
- **æ•°æ®å®‰å…¨**: æœ¬åœ°æ•°æ®æŒä¹…åŒ–

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### æ•´ä½“æ¶æ„å›¾
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å‰ç«¯ (Next.js) â”‚â”€â”€â”€â”€â”‚   API Routes    â”‚â”€â”€â”€â”€â”‚   MySQLæ•°æ®åº“    â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚ - Reactç»„ä»¶     â”‚    â”‚ - é¡¹ç›®ç®¡ç†      â”‚    â”‚ - é¡¹ç›®æ•°æ®      â”‚
â”‚ - çŠ¶æ€ç®¡ç†      â”‚    â”‚ - åˆ†æ”¯ç®¡ç†      â”‚    â”‚ - åˆ†æ”¯æ•°æ®      â”‚
â”‚ - è·¯ç”±ç®¡ç†      â”‚    â”‚ - ç‰ˆæœ¬æ§åˆ¶      â”‚    â”‚ - ç‰ˆæœ¬æ•°æ®      â”‚
â”‚ - UIäº¤äº’        â”‚    â”‚ - æ–‡ä»¶æ“ä½œ      â”‚    â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŠ€æœ¯æ ˆé€‰æ‹©

#### å‰ç«¯æŠ€æœ¯æ ˆ
- **æ¡†æ¶**: Next.js 14 (App Router)
  - æœåŠ¡ç«¯æ¸²æŸ“æ”¯æŒ
  - å†…ç½®API Routes
  - ç®€å•éƒ¨ç½²
  
- **UIæ¡†æ¶**: 
  - Tailwind CSS: åŸå­åŒ–CSSæ¡†æ¶
  - Shadcn/ui: é«˜è´¨é‡ç»„ä»¶åº“
  - Lucide React: å›¾æ ‡åº“
  
- **çŠ¶æ€ç®¡ç†**: Zustand
  - è½»é‡çº§çŠ¶æ€ç®¡ç†
  - TypeScriptå‹å¥½
  
- **å¯è§†åŒ–**: 
  - React Flow: åˆ†æ”¯å›¾å¯è§†åŒ–
  - Monaco Editor: ä»£ç ç¼–è¾‘å™¨
  
- **å…¶ä»–å·¥å…·**:
  - React Hook Form: è¡¨å•ç®¡ç†
  - diffåº“: æ–‡æœ¬å·®å¼‚å¯¹æ¯”

#### åç«¯æŠ€æœ¯æ ˆ
- **è¿è¡Œæ—¶**: Node.js + TypeScript
- **æ¡†æ¶**: Next.js API Routes
- **æ•°æ®åº“**: MySQL 8.0+
- **ORM**: Prisma
  - ç±»å‹å®‰å…¨çš„æ•°æ®åº“å®¢æˆ·ç«¯
  - è‡ªåŠ¨ç”ŸæˆTypeScriptç±»å‹
  - æ•°æ®åº“è¿ç§»ç®¡ç†

## ğŸ—„ï¸ æ•°æ®åº“è®¾è®¡

### ERå›¾
```
Projects ||--o{ Branches : contains
Branches ||--o{ Commits : contains  
Commits }o--|| Commits : parent_of
```

### æ•°æ®è¡¨ç»“æ„

#### é¡¹ç›®è¡¨ (projects)
```sql
CREATE TABLE projects (
    id VARCHAR(36) PRIMARY KEY,
    name VARCHAR(100) NOT NULL UNIQUE,
    description TEXT,
    default_branch VARCHAR(100) DEFAULT 'main',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    INDEX idx_name (name)
);
```

#### åˆ†æ”¯è¡¨ (branches)
```sql
CREATE TABLE branches (
    id VARCHAR(36) PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    project_id VARCHAR(36) NOT NULL,
    is_default BOOLEAN DEFAULT FALSE,
    last_commit_id VARCHAR(36),
    created_from_commit_id VARCHAR(36),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    FOREIGN KEY (project_id) REFERENCES projects(id) ON DELETE CASCADE,
    FOREIGN KEY (last_commit_id) REFERENCES commits(id) ON DELETE SET NULL,
    FOREIGN KEY (created_from_commit_id) REFERENCES commits(id) ON DELETE SET NULL,
    UNIQUE KEY unique_branch_per_project (project_id, name),
    INDEX idx_project_id (project_id),
    INDEX idx_last_commit_id (last_commit_id)
);
```

#### æäº¤è¡¨ (commits)
```sql
CREATE TABLE commits (
    id VARCHAR(36) PRIMARY KEY,
    message VARCHAR(500) NOT NULL,
    content LONGTEXT NOT NULL,
    branch_id VARCHAR(36) NOT NULL,
    parent_commit_id VARCHAR(36),
    commit_hash VARCHAR(64) UNIQUE NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    FOREIGN KEY (branch_id) REFERENCES branches(id) ON DELETE CASCADE,
    FOREIGN KEY (parent_commit_id) REFERENCES commits(id) ON DELETE SET NULL,
    INDEX idx_branch_id (branch_id),
    INDEX idx_commit_hash (commit_hash),
    INDEX idx_created_at (created_at)
);
```

### Prismaæ•°æ®æ¨¡å‹
```prisma
// schema.prisma
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Project {
  id             String   @id @default(uuid())
  name           String   @unique
  description    String?  @db.Text
  defaultBranch  String   @default("main") @map("default_branch")
  createdAt      DateTime @default(now()) @map("created_at")
  updatedAt      DateTime @updatedAt @map("updated_at")
  
  branches       Branch[]
  
  @@map("projects")
  @@index([name])
}

model Branch {
  id                  String   @id @default(uuid())
  name                String
  projectId           String   @map("project_id")
  isDefault           Boolean  @default(false) @map("is_default")
  lastCommitId        String?  @map("last_commit_id")
  createdFromCommitId String?  @map("created_from_commit_id")
  createdAt           DateTime @default(now()) @map("created_at")
  updatedAt           DateTime @updatedAt @map("updated_at")
  
  project             Project  @relation(fields: [projectId], references: [id], onDelete: Cascade)
  lastCommit          Commit?  @relation("BranchLastCommit", fields: [lastCommitId], references: [id])
  createdFromCommit   Commit?  @relation("BranchCreatedFrom", fields: [createdFromCommitId], references: [id])
  commits             Commit[] @relation("BranchCommits")
  
  @@map("branches")
  @@unique([projectId, name], name: "unique_branch_per_project")
  @@index([projectId])
  @@index([lastCommitId])
}

model Commit {
  id             String   @id @default(uuid())
  message        String   @db.VarChar(500)
  content        String   @db.LongText
  branchId       String   @map("branch_id")
  parentCommitId String?  @map("parent_commit_id")
  commitHash     String   @unique @map("commit_hash") @db.VarChar(64)
  createdAt      DateTime @default(now()) @map("created_at")
  
  branch         Branch   @relation("BranchCommits", fields: [branchId], references: [id], onDelete: Cascade)
  parentCommit   Commit?  @relation("CommitParent", fields: [parentCommitId], references: [id])
  childCommits   Commit[] @relation("CommitParent")
  
  // åå‘å…³ç³»
  branchesLastCommit    Branch[] @relation("BranchLastCommit")
  branchesCreatedFrom   Branch[] @relation("BranchCreatedFrom")
  
  @@map("commits")
  @@index([branchId])
  @@index([commitHash])
  @@index([createdAt])
}
```

## ğŸ”Œ APIæ¥å£è®¾è®¡

### é¡¹ç›®ç®¡ç†æ¥å£
```typescript
// è·å–æ‰€æœ‰é¡¹ç›®åˆ—è¡¨
GET /api/projects

// åˆ›å»ºé¡¹ç›®
POST /api/projects
{
  name: string;
  description?: string;
}

// è·å–é¡¹ç›®è¯¦æƒ…
GET /api/projects/[id]

// æ›´æ–°é¡¹ç›®
PUT /api/projects/[id]
{
  name?: string;
  description?: string;
}

// åˆ é™¤é¡¹ç›®
DELETE /api/projects/[id]
```

### åˆ†æ”¯ç®¡ç†æ¥å£
```typescript
// è·å–é¡¹ç›®çš„åˆ†æ”¯åˆ—è¡¨
GET /api/projects/[id]/branches

// åˆ›å»ºåˆ†æ”¯
POST /api/projects/[id]/branches
{
  name: string;
  sourceCommitId?: string; // åŸºäºæŸä¸ªcommitåˆ›å»ºåˆ†æ”¯ï¼Œä¸ä¼ åˆ™åŸºäºé»˜è®¤åˆ†æ”¯æœ€æ–°commit
}

// è·å–åˆ†æ”¯è¯¦æƒ…ï¼ˆåŒ…å«æœ€æ–°å†…å®¹ï¼‰
GET /api/projects/[id]/branches/[branchName]

// è·å–åˆ†æ”¯å½“å‰å†…å®¹
GET /api/projects/[id]/branches/[branchName]/content

// åˆ é™¤åˆ†æ”¯
DELETE /api/projects/[id]/branches/[branchName]
```

### ç‰ˆæœ¬ç®¡ç†æ¥å£
```typescript
// è·å–åˆ†æ”¯çš„æäº¤å†å²
GET /api/projects/[id]/branches/[branchName]/commits

// åˆ›å»ºæäº¤(ä¿å­˜ç‰ˆæœ¬)
POST /api/projects/[id]/branches/[branchName]/commits
{
  message: string;
  content: string;
}

// è·å–æäº¤è¯¦æƒ…
GET /api/projects/[id]/branches/[branchName]/commits/[commitId]

// å›æ»šåˆ°æŒ‡å®šæäº¤
POST /api/projects/[id]/branches/[branchName]/commits/[commitId]/revert

// è·å–ä¸¤ä¸ªæäº¤ä¹‹é—´çš„å·®å¼‚
GET /api/projects/[id]/branches/[branchName]/commits/[commitId]/diff?compare=[otherCommitId]
```

## ğŸ’¼ æ ¸å¿ƒä¸šåŠ¡æµç¨‹

### é¡¹ç›®åˆå§‹åŒ–æµç¨‹
```typescript
// 1. åˆ›å»ºé¡¹ç›®
const project = await createProject({
  name: "AIå†™ä½œåŠ©æ‰‹",
  description: "ç”¨äºç”Ÿæˆæ–‡ç« çš„æç¤ºè¯é›†åˆ"
});

// 2. è‡ªåŠ¨åˆ›å»ºé»˜è®¤åˆ†æ”¯å’Œåˆå§‹æäº¤
const defaultBranch = await createBranch(project.id, {
  name: "main",
  isDefault: true
});

const initialCommit = await createCommit(project.id, "main", {
  message: "åˆå§‹æäº¤",
  content: "// åœ¨è¿™é‡Œç¼–å†™ä½ çš„æç¤ºè¯\n"
});

// 3. æ›´æ–°åˆ†æ”¯çš„æœ€æ–°commit
await updateBranch(project.id, "main", {
  lastCommitId: initialCommit.id
});
```

### åˆ†æ”¯åˆ›å»ºæµç¨‹
```typescript
// 1. åŸºäºç°æœ‰commitåˆ›å»ºæ–°åˆ†æ”¯
const newBranch = await createBranch(project.id, {
  name: "feature/æ–°åŠŸèƒ½",
  sourceCommitId: "existing-commit-id"
});

// 2. æ–°åˆ†æ”¯è‡ªåŠ¨ç»§æ‰¿æºcommitçš„å†…å®¹
// 3. è®¾ç½®æ–°åˆ†æ”¯çš„last_commit_idä¸ºæºcommit
```

### ç‰ˆæœ¬ä¿å­˜æµç¨‹
```typescript
// 1. ç”¨æˆ·åœ¨ç¼–è¾‘å™¨ä¸­ä¿®æ”¹å†…å®¹
// 2. è‡ªåŠ¨ä¿å­˜åˆ°è‰ç¨¿çŠ¶æ€
// 3. ç”¨æˆ·ç‚¹å‡»"æäº¤"æŒ‰é’®
const newCommit = await createCommit(project.id, branchName, {
  message: "ä¼˜åŒ–å†™ä½œé£æ ¼",
  content: updatedContent
});

// 4. æ›´æ–°åˆ†æ”¯çš„æœ€æ–°commit
await updateBranch(project.id, branchName, {
  lastCommitId: newCommit.id
});
```

### ç‰ˆæœ¬å›æ»šæµç¨‹
```typescript
// 1. ç”¨æˆ·é€‰æ‹©è¦å›æ»šåˆ°çš„commit
// 2. åˆ›å»ºæ–°çš„commitï¼Œå†…å®¹ä¸ºç›®æ ‡commitçš„å†…å®¹
const revertCommit = await createCommit(project.id, branchName, {
  message: `å›æ»šåˆ° ${targetCommit.message}`,
  content: targetCommit.content,
  parentCommitId: currentCommit.id
});

// 3. æ›´æ–°åˆ†æ”¯æŒ‡é’ˆ
await updateBranch(project.id, branchName, {
  lastCommitId: revertCommit.id
});
```

## ğŸ¨ ç•Œé¢è®¾è®¡

### é¡µé¢ç»“æ„
```
â”œâ”€â”€ / (é¡¹ç›®åˆ—è¡¨é¦–é¡µ)
â”œâ”€â”€ /projects/new (åˆ›å»ºé¡¹ç›®)
â”œâ”€â”€ /projects/[id] (é¡¹ç›®è¯¦æƒ…)
â”‚   â”œâ”€â”€ /branches (åˆ†æ”¯åˆ—è¡¨)
â”‚   â”œâ”€â”€ /branches/[name] (åˆ†æ”¯è¯¦æƒ…)
â”‚   â”œâ”€â”€ /branches/[name]/edit (ç¼–è¾‘æç¤ºè¯)
â”‚   â”œâ”€â”€ /branches/[name]/history (ç‰ˆæœ¬å†å²)
â”‚   â””â”€â”€ /branches/[name]/compare (ç‰ˆæœ¬å¯¹æ¯”)
```

### æ ¸å¿ƒç»„ä»¶è®¾è®¡

#### 1. é¡¹ç›®ä»ªè¡¨æ¿
- **åŠŸèƒ½**: æ˜¾ç¤ºæ‰€æœ‰é¡¹ç›®åˆ—è¡¨
- **ç»„ä»¶**: 
  - é¡¹ç›®å¡ç‰‡ç½‘æ ¼
  - æœç´¢è¿‡æ»¤å™¨
  - åˆ›å»ºé¡¹ç›®æŒ‰é’®
  - æœ€è¿‘æ´»åŠ¨æ˜¾ç¤º

#### 2. åˆ†æ”¯ç®¡ç†ç•Œé¢
- **åŠŸèƒ½**: é¡¹ç›®å†…çš„åˆ†æ”¯ç®¡ç†
- **ç»„ä»¶**:
  - åˆ†æ”¯åˆ—è¡¨
  - åˆ›å»ºåˆ†æ”¯æŒ‰é’®
  - åˆ†æ”¯åˆ‡æ¢
  - åˆ†æ”¯åˆ é™¤æ“ä½œ

#### 3. æç¤ºè¯ç¼–è¾‘å™¨
- **åŠŸèƒ½**: ç¼–è¾‘å’Œé¢„è§ˆæç¤ºè¯
- **æŠ€æœ¯**: Monaco Editor
- **ç‰¹æ€§**:
  - è¯­æ³•é«˜äº®
  - å®æ—¶é¢„è§ˆ
  - è‡ªåŠ¨ä¿å­˜
  - å…¨å±ç¼–è¾‘

#### 4. ç‰ˆæœ¬å†å²è§†å›¾
- **åŠŸèƒ½**: æ˜¾ç¤ºåˆ†æ”¯çš„ç‰ˆæœ¬å†å²
- **ç»„ä»¶**:
  - æäº¤æ—¶é—´çº¿
  - ç‰ˆæœ¬å·®å¼‚å¯¹æ¯”
  - å›æ»šæ“ä½œæŒ‰é’®
  - ç‰ˆæœ¬è¯¦æƒ…é¢„è§ˆ

### UI/UXè®¾è®¡åŸåˆ™

#### è®¾è®¡è¯­è¨€
- **é£æ ¼**: ç°ä»£ç®€æ´ï¼Œç±»ä¼¼GitHub
- **è‰²å½©**: è“è‰²ä¸»é¢˜ï¼Œé«˜å¯¹æ¯”åº¦
- **å­—ä½“**: ç³»ç»Ÿå­—ä½“æ ˆ
- **å›¾æ ‡**: Lucide Reactå›¾æ ‡é›†

#### äº¤äº’è®¾è®¡
- **æ“ä½œåé¦ˆ**: æ‰€æœ‰æ“ä½œéƒ½æœ‰æ˜ç¡®çš„æˆåŠŸ/å¤±è´¥åé¦ˆ
- **åŠ è½½çŠ¶æ€**: éª¨æ¶å±å’Œè¿›åº¦æŒ‡ç¤ºå™¨
- **é”™è¯¯å¤„ç†**: å‹å¥½çš„é”™è¯¯ä¿¡æ¯å’Œå»ºè®®
- **å¿«æ·æ“ä½œ**: é”®ç›˜å¿«æ·é”®æ”¯æŒ

## ğŸ” æ•°æ®å®‰å…¨

### æ•°æ®ä¿æŠ¤
- **è¾“å…¥éªŒè¯**: ä¸¥æ ¼çš„è¾“å…¥éªŒè¯å’Œæ¸…ç†
- **SQLæ³¨å…¥é˜²æŠ¤**: Prisma ORMå‚æ•°åŒ–æŸ¥è¯¢
- **XSSé˜²æŠ¤**: è¾“å…¥è½¬ä¹‰å’Œå†…å®¹è¿‡æ»¤

### æ•°æ®æŒä¹…åŒ–
- **è‡ªåŠ¨ä¿å­˜**: å®šæœŸè‡ªåŠ¨ä¿å­˜ç¼–è¾‘å†…å®¹
- **æ•°æ®å¤‡ä»½**: å®šæœŸæ•°æ®åº“å¤‡ä»½
- **ç‰ˆæœ¬è¿½è¸ª**: å®Œæ•´çš„å˜æ›´å†å²è®°å½•

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### å‰ç«¯ä¼˜åŒ–
- **ä»£ç åˆ†å‰²**: è·¯ç”±çº§åˆ«çš„æ‡’åŠ è½½
- **ç¼“å­˜ç­–ç•¥**: React Queryæ•°æ®ç¼“å­˜
- **å›¾ç‰‡ä¼˜åŒ–**: Next.js Imageç»„ä»¶
- **CDN**: é™æ€èµ„æºCDNåˆ†å‘

### åç«¯ä¼˜åŒ–
- **æ•°æ®åº“ä¼˜åŒ–**: 
  - åˆç†çš„ç´¢å¼•è®¾è®¡
  - æŸ¥è¯¢ä¼˜åŒ–
  - è¿æ¥æ± ç®¡ç†
- **ç¼“å­˜ç­–ç•¥**: Redisç¼“å­˜çƒ­ç‚¹æ•°æ®
- **APIä¼˜åŒ–**: 
  - GraphQLæŒ‰éœ€æŸ¥è¯¢
  - æ•°æ®åˆ†é¡µ
  - å“åº”å‹ç¼©

### æ•°æ®åº“ä¼˜åŒ–
- **ç´¢å¼•ç­–ç•¥**: é’ˆå¯¹æŸ¥è¯¢æ¨¡å¼å»ºç«‹ç´¢å¼•
- **åˆ†è¡¨åˆ†åº“**: å¤§æ•°æ®é‡æ—¶çš„æ°´å¹³åˆ†å‰²
- **è¯»å†™åˆ†ç¦»**: ä¸»ä»å¤åˆ¶æ¶æ„
- **ç›‘æ§å‘Šè­¦**: æ•°æ®åº“æ€§èƒ½ç›‘æ§

## ğŸš€ éƒ¨ç½²æ¶æ„

### å¼€å‘ç¯å¢ƒ
```
å¼€å‘è€…æœ¬åœ° â†’ Dockerå®¹å™¨ â†’ MySQLæœ¬åœ°å®ä¾‹
```

### ç”Ÿäº§ç¯å¢ƒ  
```
ç”¨æˆ· â†’ CDN â†’ è´Ÿè½½å‡è¡¡å™¨ â†’ Next.jsåº”ç”¨é›†ç¾¤ â†’ MySQLä¸»ä»é›†ç¾¤
                         â†“
                    Redisç¼“å­˜é›†ç¾¤
```

### æŠ€æœ¯æ ˆéƒ¨ç½²
- **å®¹å™¨åŒ–**: Docker + Docker Compose
- **ç¼–æ’**: Kubernetes (å¯é€‰)
- **CI/CD**: GitHub Actions
- **ç›‘æ§**: Prometheus + Grafana
- **æ—¥å¿—**: ELK Stack

## ğŸ“ˆ ç›‘æ§å‘Šè­¦

### åº”ç”¨ç›‘æ§
- **æ€§èƒ½æŒ‡æ ‡**: å“åº”æ—¶é—´ã€ååé‡ã€é”™è¯¯ç‡
- **ç”¨æˆ·ä½“éªŒ**: Core Web Vitals
- **ä¸šåŠ¡æŒ‡æ ‡**: ç”¨æˆ·æ´»è·ƒåº¦ã€ä»“åº“ä½¿ç”¨æƒ…å†µ

### åŸºç¡€è®¾æ–½ç›‘æ§
- **æœåŠ¡å™¨**: CPUã€å†…å­˜ã€ç£ç›˜ã€ç½‘ç»œ
- **æ•°æ®åº“**: è¿æ¥æ•°ã€æŸ¥è¯¢æ€§èƒ½ã€é”ç­‰å¾…
- **ç¼“å­˜**: å‘½ä¸­ç‡ã€å†…å­˜ä½¿ç”¨

### å‘Šè­¦ç­–ç•¥
- **åˆ†çº§å‘Šè­¦**: P0(ç´§æ€¥) â†’ P3(ä¸€èˆ¬)
- **é€šçŸ¥æ¸ é“**: é‚®ä»¶ã€çŸ­ä¿¡ã€é’‰é’‰
- **è‡ªåŠ¨æ¢å¤**: ç®€å•æ•…éšœè‡ªåŠ¨å¤„ç†

## ğŸ”„ ç‰ˆæœ¬æ§åˆ¶ç®—æ³•

### Git-likeç‰ˆæœ¬æ§åˆ¶å®ç°

#### 1. æäº¤(Commit)ç®—æ³•
```typescript
interface CommitAlgorithm {
  // åˆ›å»ºæäº¤
  createCommit(content: string, message: string, parentId?: string): Commit
  
  // è®¡ç®—å†…å®¹å“ˆå¸Œ
  calculateHash(content: string, timestamp: number): string
  
  // éªŒè¯æäº¤é“¾
  validateCommitChain(commits: Commit[]): boolean
}

// å…·ä½“å®ç°
class CommitService implements CommitAlgorithm {
  async createCommit(branchId: string, content: string, message: string): Promise<Commit> {
    const timestamp = Date.now();
    const hash = this.calculateHash(content, timestamp);
    
    // è·å–åˆ†æ”¯å½“å‰æœ€æ–°commitä½œä¸ºparent
    const branch = await this.getBranch(branchId);
    const parentCommitId = branch.last_commit_id;
    
    const commit = await this.db.commits.create({
      data: {
        id: generateUUID(),
        message,
        content,
        branch_id: branchId,
        parent_commit_id: parentCommitId,
        commit_hash: hash,
        created_at: new Date(timestamp)
      }
    });
    
    // æ›´æ–°åˆ†æ”¯çš„æœ€æ–°commitæŒ‡é’ˆ
    await this.db.branches.update({
      where: { id: branchId },
      data: { last_commit_id: commit.id }
    });
    
    return commit;
  }
  
  calculateHash(content: string, timestamp: number): string {
    const crypto = require('crypto');
    const data = `${content}${timestamp}`;
    return crypto.createHash('sha256').update(data).digest('hex');
  }
  
  async validateCommitChain(branchId: string): Promise<boolean> {
    const commits = await this.db.commits.findMany({
      where: { branch_id: branchId },
      orderBy: { created_at: 'asc' }
    });
    
    // éªŒè¯æ¯ä¸ªcommitçš„parentå…³ç³»
    for (let i = 1; i < commits.length; i++) {
      if (commits[i].parent_commit_id !== commits[i-1].id) {
        return false;
      }
    }
    return true;
  }
}
```

#### 2. åˆ†æ”¯(Branch)ç®¡ç†
```typescript
interface BranchAlgorithm {
  // åˆ›å»ºåˆ†æ”¯
  createBranch(name: string, sourceCommitId: string): Branch
  
  // åˆ†æ”¯åˆ‡æ¢
  checkoutBranch(branchId: string): BranchState
  
  // è·å–åˆ†æ”¯å·®å¼‚
  getBranchDiff(branch1: string, branch2: string): Diff[]
}
```

#### 3. åˆå¹¶(Merge)ç®—æ³•
```typescript
interface MergeAlgorithm {
  // ä¸‰è·¯åˆå¹¶
  threeWayMerge(base: string, source: string, target: string): MergeResult
  
  // å†²çªæ£€æµ‹
  detectConflicts(source: string, target: string): Conflict[]
  
  // è‡ªåŠ¨åˆå¹¶
  autoMerge(sourceCommit: string, targetCommit: string): MergeResult
}
```

#### 4. å·®å¼‚å¯¹æ¯”ç®—æ³•
```typescript
interface DiffAlgorithm {
  // Myerså·®å¼‚ç®—æ³•
  calculateDiff(oldText: string, newText: string): DiffLine[]
  
  // å•è¯çº§å·®å¼‚
  wordLevelDiff(oldText: string, newText: string): WordDiff[]
  
  // è¯­ä¹‰å·®å¼‚(AIå¢å¼º)
  semanticDiff(oldPrompt: string, newPrompt: string): SemanticDiff[]
}
```

## ğŸ§ª æµ‹è¯•ç­–ç•¥

### æµ‹è¯•é‡‘å­—å¡”
```
        E2Eæµ‹è¯• (10%)
    â†—               â†–
é›†æˆæµ‹è¯• (20%)      APIæµ‹è¯• (20%)  
    â†—                       â†–
        å•å…ƒæµ‹è¯• (50%)
```

### æµ‹è¯•å·¥å…·
- **å•å…ƒæµ‹è¯•**: Jest + React Testing Library
- **é›†æˆæµ‹è¯•**: Supertest
- **E2Eæµ‹è¯•**: Playwright
- **æ€§èƒ½æµ‹è¯•**: K6
- **å®‰å…¨æµ‹è¯•**: OWASP ZAP

### æµ‹è¯•è¦†ç›–ç‡
- **ä»£ç è¦†ç›–ç‡**: >90%
- **åˆ†æ”¯è¦†ç›–ç‡**: >85%
- **åŠŸèƒ½è¦†ç›–ç‡**: >95%

## ğŸ“ å¼€å‘è§„èŒƒ

### ä»£ç è§„èŒƒ
- **TypeScript**: ä¸¥æ ¼æ¨¡å¼
- **ESLint**: Airbnbé…ç½®
- **Prettier**: ä»£ç æ ¼å¼åŒ–
- **Husky**: Git hooks
- **Conventional Commits**: æäº¤ä¿¡æ¯è§„èŒƒ

### æ–‡æ¡£è§„èŒƒ
- **APIæ–‡æ¡£**: OpenAPI 3.0
- **ä»£ç æ³¨é‡Š**: TSDocè§„èŒƒ
- **README**: é¡¹ç›®è¯´æ˜
- **CHANGELOG**: ç‰ˆæœ¬å˜æ›´æ—¥å¿—

## ğŸ›ï¸ é…ç½®ç®¡ç†

### ç¯å¢ƒé…ç½®
```bash
# .env.local (å¼€å‘ç¯å¢ƒ)
DATABASE_URL="mysql://root:password@localhost:3306/prompthub_dev"
NEXTAUTH_SECRET="your-secret-key"
NEXTAUTH_URL="http://localhost:3000"

# .env.production (ç”Ÿäº§ç¯å¢ƒ)  
DATABASE_URL="mysql://user:password@prod-host:3306/prompthub_prod"
NEXTAUTH_SECRET="production-secret-key"
NEXTAUTH_URL="https://your-domain.com"
```

### Next.jsé…ç½®
```javascript
// next.config.js
/** @type {import('next').NextConfig} */
const nextConfig = {
  experimental: {
    appDir: true,
  },
  env: {
    DATABASE_URL: process.env.DATABASE_URL,
  }
}

module.exports = nextConfig
```

### Package.jsonè„šæœ¬
```json
{
  "scripts": {
    "dev": "next dev",
    "build": "next build", 
    "start": "next start",
    "lint": "next lint",
    "db:push": "prisma db push",
    "db:studio": "prisma studio",
    "db:generate": "prisma generate",
    "db:migrate": "prisma migrate dev",
    "db:seed": "tsx prisma/seed.ts"
  }
}
```

### APIå®ç°ç¤ºä¾‹
```typescript
// app/api/projects/route.ts
import { NextResponse } from 'next/server';
import { PrismaClient } from '@prisma/client';

const prisma = new PrismaClient();

export async function GET() {
  try {
    const projects = await prisma.project.findMany({
      include: {
        branches: {
          where: { isDefault: true },
          include: {
            lastCommit: true
          }
        }
      },
      orderBy: { updatedAt: 'desc' }
    });
    
    return NextResponse.json(projects);
  } catch (error) {
    return NextResponse.json(
      { error: 'è·å–é¡¹ç›®åˆ—è¡¨å¤±è´¥' },
      { status: 500 }
    );
  }
}

export async function POST(request: Request) {
  try {
    const { name, description } = await request.json();
    
    // åˆ›å»ºé¡¹ç›®
    const project = await prisma.project.create({
      data: { name, description }
    });
    
    // åˆ›å»ºé»˜è®¤åˆ†æ”¯
    const defaultBranch = await prisma.branch.create({
      data: {
        name: 'main',
        projectId: project.id,
        isDefault: true
      }
    });
    
    // åˆ›å»ºåˆå§‹æäº¤
    const initialCommit = await prisma.commit.create({
      data: {
        message: 'åˆå§‹æäº¤',
        content: '// åœ¨è¿™é‡Œç¼–å†™ä½ çš„æç¤ºè¯\n',
        branchId: defaultBranch.id,
        commitHash: generateHash('// åœ¨è¿™é‡Œç¼–å†™ä½ çš„æç¤ºè¯\n' + Date.now())
      }
    });
    
    // æ›´æ–°åˆ†æ”¯çš„æœ€æ–°æäº¤
    await prisma.branch.update({
      where: { id: defaultBranch.id },
      data: { lastCommitId: initialCommit.id }
    });
    
    return NextResponse.json(project, { status: 201 });
  } catch (error) {
    return NextResponse.json(
      { error: 'åˆ›å»ºé¡¹ç›®å¤±è´¥' },
      { status: 500 }
    );
  }
}
```

## ğŸ“‹ é¡¹ç›®è®¡åˆ’

### ç¬¬ä¸€é˜¶æ®µ (åŸºç¡€åŠŸèƒ½ - 3å‘¨)
- [ ] é¡¹ç›®ç®¡ç†(åˆ›å»ºã€åˆ é™¤ã€åˆ—è¡¨)
- [ ] åŸºç¡€ç•Œé¢æ­å»º
- [ ] æ•°æ®åº“è®¾è®¡å’Œå®ç°
- [ ] åŸºç¡€APIæ¥å£

### ç¬¬äºŒé˜¶æ®µ (ç‰ˆæœ¬æ§åˆ¶ - 4å‘¨)  
- [ ] åˆ†æ”¯ç®¡ç†åŠŸèƒ½
- [ ] æäº¤å’Œç‰ˆæœ¬å†å²
- [ ] å·®å¼‚å¯¹æ¯”åŠŸèƒ½
- [ ] å›æ»šæ“ä½œ

### ç¬¬ä¸‰é˜¶æ®µ (ç¼–è¾‘å™¨ - 3å‘¨)
- [ ] Monacoç¼–è¾‘å™¨é›†æˆ
- [ ] å®æ—¶é¢„è§ˆåŠŸèƒ½
- [ ] è‡ªåŠ¨ä¿å­˜æœºåˆ¶
- [ ] å¿«æ·é”®æ”¯æŒ

### ç¬¬å››é˜¶æ®µ (ä¼˜åŒ–å®Œå–„ - 2å‘¨)
- [ ] æ€§èƒ½ä¼˜åŒ–
- [ ] ç•Œé¢ç¾åŒ–
- [ ] é”™è¯¯å¤„ç†
- [ ] éƒ¨ç½²ä¸Šçº¿

## ğŸ”® æœªæ¥æ‰©å±•

### åŠŸèƒ½å¢å¼º
- **æ™ºèƒ½æç¤º**: AIè¾…åŠ©ç¼–å†™æç¤ºè¯
- **æ¨¡æ¿ç®¡ç†**: å¸¸ç”¨æç¤ºè¯æ¨¡æ¿
- **æœç´¢åŠŸèƒ½**: å…¨æ–‡æœç´¢å’Œæ ‡ç­¾åˆ†ç±»
- **å¯¼å…¥å¯¼å‡º**: æ”¯æŒå¤šç§æ ¼å¼å¯¼å…¥å¯¼å‡º

### é«˜çº§åŠŸèƒ½
- **å›¢é˜Ÿåä½œ**: å¤šäººåä½œç¼–è¾‘
- **APIé›†æˆ**: ä¸AIæ¨¡å‹APIé›†æˆæµ‹è¯•
- **ç‰ˆæœ¬æ ‡ç­¾**: ç‰ˆæœ¬æ ‡ç­¾å’Œå‘å¸ƒç®¡ç†
- **ç»Ÿè®¡åˆ†æ**: ä½¿ç”¨æƒ…å†µç»Ÿè®¡

### ç”Ÿæ€æ‰©å±•
- **æµè§ˆå™¨æ’ä»¶**: å¿«æ·è®¿é—®å’Œä½¿ç”¨
- **CLIå·¥å…·**: å‘½ä»¤è¡Œæ“ä½œå·¥å…·
- **ç§»åŠ¨åº”ç”¨**: ç§»åŠ¨ç«¯æŸ¥çœ‹å’Œç¼–è¾‘
- **ç¬¬ä¸‰æ–¹é›†æˆ**: ä¸å…¶ä»–å·¥å…·é›†æˆ

---

*æœ¬æ–‡æ¡£å°†éšç€é¡¹ç›®è¿›å±•æŒç»­æ›´æ–°å’Œå®Œå–„*
